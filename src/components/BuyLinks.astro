---
/**
 * BuyLinks Component
 *
 * Displays a list of prominent, touch-friendly buttons for purchasing books
 * from various retailers. Uses consistent Tabler Icons for visual clarity
 * and accessibility.
 *
 * @param buyLinks - Array of {name, url} objects for each retailer
 * @param status - Book status: "published" | "upcoming" | "draft"
 * @param class - Optional additional CSS classes
 */

import IconBuildingStore from "@/assets/icons/IconBuildingStore.svg";
import IconExternalLink from "@/assets/icons/IconExternalLink.svg";

export interface Props {
  buyLinks: Array<{
    name: string;
    url: string;
  }>;
  status: "published" | "upcoming" | "draft";
  class?: string;
}

const { buyLinks = [], status = "published", class: className = "" } = Astro.props;

// Determine the heading text based on status
const headingText = status === "published" ? "Buy Now" : "Pre-Order";
---

{buyLinks.length > 0 ? (
  <div class:list={["space-y-3", className]}>
    <h2 class="text-xl font-bold text-foreground">
      {headingText}
    </h2>
    {buyLinks.map(link => (
      <a
        href={link.url}
        target="_blank"
        rel="noopener noreferrer"
        class="flex items-center justify-between gap-3 rounded-lg bg-accent px-6 py-4 font-semibold text-white transition-all hover:bg-accent/90 hover:shadow-lg focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-accent group min-h-[48px]"
        aria-label={`${headingText === "Buy Now" ? "Buy" : "Pre-order"} ${link.name} (opens in new tab)`}
        data-buy-link
      >
        <span class="flex items-center gap-3 flex-1">
          <IconBuildingStore class="h-5 w-5 flex-shrink-0" aria-hidden="true" />
          <span class="text-left">{link.name}</span>
        </span>
        <IconExternalLink class="h-4 w-4 flex-shrink-0 opacity-80 group-hover:opacity-100 transition-opacity" aria-hidden="true" />
      </a>
    ))}
  </div>
) : (
  <div class:list={["rounded-lg border border-border bg-muted p-4 text-center", className]}>
    <p class="text-foreground/70">
      {status === "upcoming"
        ? "Pre-order links coming soon"
        : "Purchase links coming soon"}
    </p>
  </div>
)}
